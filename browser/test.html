<!DOCTYPE html>
<html>
	<head>
	</head>
	<body>
<textarea id="ta">
var hutonTimeRemaining = AuraTimeRemaining(self, "Huton", self),
	hasSuiton = AuraCount(self, "Suiton", self);

if(AuraCount(self, "Mudra", self)) {
	return "Ninjutsu";
}

if(IsOffGCD()) {

	if(IsReady("BloodForBlood"))
		return "BloodForBlood";

	if(IsReady("InternalRelease"))
		return "InternalRelease";

	if(IsReady("Kassatsu") && AuraTimeRemaining(target, "TrickAttack", self))
		return "Kassatsu";

// }

if(CooldownRemaining("Ninjutsu") < 1 && AuraTimeRemaining(target, "DancingEdge", self)) {
	if(hutonTimeRemaining < 20)
		return "Huton";
	else if(IsReady("TrickAttack"))
		return "Suiton";
	else
		return "Raiton";
}

// if(IsOffGCD()) {

	if(hasSuiton && IsReady("TrickAttack")) 
		return "TrickAttack";

	if(IsReady("Mug"))
		return "Mug";

	if(IsReady("Jugulate"))
		return "Jugulate";

}

if(IsReady("ShadowFang") && AuraTimeRemaining(target, "ShadowFangDOT", self) < 9
					     && AuraTimeRemaining(target, "DancingEdge", self))
	return "ShadowFang";

if(IsReady("GustSlash"))
	return "GustSlash";

if(IsReady("DancingEdge") && AuraTimeRemaining(target, "DancingEdge", self) < 9)
	return "DancingEdge";

if(IsReady("AeolianEdge"))
	return "AeolianEdge";

if(IsReady("Mutilate") && AuraTimeRemaining(target, "MutilateDOT", self) < 9
					   && AuraTimeRemaining(target, "ShadowFangDOT", self))
	return "Mutilate";


return "SpinningEdge";
</textarea>
<button id="go" value="go">go</button>
		<script type="text/javascript" src="js/themonk.js"></script>
		<script type="text/javascript" src="js/index.js"></script>
		<script>
			var TheMonk = require("themonk"),
				go = document.querySelector("#go"),
				ta = document.querySelector("#ta");

			function sim() {
				var themonk = new TheMonk().on("error", function(e) {
						switch(e.name) {
							case "RotationError":
							case "RotationSyntaxError":
								console.error(e.stack);
								console.error(e.error.stack);
								break;
							default:
								console.error(e.stack);
						}
						throw e;
					})
					.on("warn", function(warn) {
						console.warn(warn);
					}).addActor("Ninja", "Ninja", {
	"model":						"Ninja", 
	"weaponDamage": 				58,
	"weaponAutoAttack": 			46.40,
	"weaponAutoAttackDelay": 		2.40,
	"strength": 					670,
	"critical": 					507,
	"determination": 				358,
	"skillSpeed": 					376
}, ta.value)
					.setMaxTime(600)
					.run()
					.on("progress", function(time, maxTime) {
						go.textContent = parseInt(time / maxTime * 100) + "%";
					})
					.on("end", function(duration) {
						go.textContent = go.value;
						console.log("done");
					});
			}

			go.addEventListener("click", sim, false);
		</script>
	</body>
</html>